---
title: "Introduction"
---
Cobo Wallet-as-a-Service (WaaS) 2.0 API enables you to access Cobo's full suite of crypto wallet technologies with powerful and flexible access controls. The HTTP-based SaaS API provides a variety of capabilities, including managing wallets and addresses, sending and receiving tokens, setting up notifications and callbacks.

## HTTP methods
The WaaS service supports common HTTP methods. For HTTP POST request, the WaaS service accepts payloads in JSON format.

## HTTP hosts
The WaaS service offers several HTTP host for different use cases: 
- Development environment: `https://api.dev.cobo.com`
- Production environment: `https://api.custody.cobo.com`
- Test environment: `https://api.sandbox.cobo.com`

## Authentication
To ensure secure access to your crypto assets via APIs, the WaaS service validates the use of ECDSA signatures for authentication in all API calls. Access to the API is denied without proper authentication. You need to provide an API key, a nonce, and an API signature in the request header as follows. 

<Note>If you are using Cobo's WaaS SDKs, you can skip this section because the SDKs already encapsulate the authentication mechanism for you.</Note>


```curl
headers = {
"Biz-Api-Key": api_key.hex(),
"Biz-Api-Nonce": timestamp,
"Biz-Api-Signature": signature.hex(),
}
```

| Field | Description | 
| ----------- | ----------- |
| `Biz-Api-KeyAPI` | An API key. To learn how to create an API key, see [ API key]().    | 
| `Biz-Api-Nonce`  | Nonce. The time when the request is sent in Unix timestamp format, measured in milliseconds. | 
| `Biz-Api-Signature` | An API signature. Cobo API Key authentication requires each request to be signed except public API interfaces. To learn how to create an API signature, see [Generate an API signature](#generate-an-api-signature).  | 

### Generate an API signature

1. Concatenate the string to be signed

    First, concatenate the string to be signed by linking required fields.

    str_to_sign = `{METHOD}|{PATH}|{TIMESTAMP}|{PARAMS}|{BODY}`

    | Field | Description | Example |
    | ----------- | ----------- |----------- |
    | METHOD     | The HTTP method.   | `GET` |
    | PATH  | The request path.   | `/v2/transactions/transfer` |
    | TIMESTAMP  | The current time in Unix timestamp format, measured in milliseconds. | `1718587017026` |
    | PARAMS   | The query parameters. To learn more about available query parameters, see [Query parameters](#query-parameters). | `chain_id=ETH&limit=10` |
    | BODY   | The request raw body in string format.  | `{"name":"Default","wallet_subtype":"Asset","wallet_type":"Custodial"}` |

2. Perform SHA-256 hashing twice on the string

    Use the `hashlib` library to perform SHA-256 hashing twice on the string as follows:
    ```python
    import hashlib

    content_hash = hashlib.sha256(hashlib.sha256(str_to_sign.encode()).digest()).digest()
    ```

3. Generate an Ed25519 key pair

    You can use either OpenSSL or the Python library `nacl` to generate an Ed25519 key pair.

    - Using OpenSSL

        In a terminal window, run the following OpenSSL commands:

        ```bash
        # Generate a private key and save it in the `private.key.pen` file.
        openssl genpkey -algorithm ed25519 -out private_key.pem
        # Extract the public key from the private key and save it in the `public.key.pen` file.
        openssl pkey -in private_key.pem -pubout -out public_key.pem
        # Export the private key in hexadecimal format.
        openssl pkey -in private_key.pem -text | grep 'priv:' -A 3 | tail -n +2 | tr -d ':\n '
        # Export the public key in hexadecimal format.
        openssl pkey -pubin -in public_key.pem -text | grep 'pub:' -A 3 | tail -n +2 | tr -d ':\n '
        ```

    - Using the `nacl` Python library

        1. Install the `nacl` library

            In a terminal window, run the following command:

            ```bash
            pip install nacl
            ```

        2. Generate a key pair

            Use the `nacl` library to generate a key pair as follows:

            ```python
            import nacl.signing

            # Generate a signing key (private key)
            signing_key = nacl.signing.SigningKey.generate()

            # Get the private key in hexadecimal format
            private_key_hex = signing_key.private_key.encode(encoder=nacl.encoding.HexEncoder).decode()

            # Get the public key in hexadecimal format
            public_key_hex = signing_key.verify_key.encode(encoder=nacl.encoding.HexEncoder).decode()
            ```

4. Sign the string with the private key

    Use the Ed25519 private key to sign the string as follows:

    ```python
    # Import the `nacl` library if you haven't.
    import nacl.signing

    # Create an Ed25519 signing Key
    sk = ed25519.SigningKey(sk_s=bytes.fromhex(api_secret))
    # Sign the hashed message
    signature = sk.sign(content_hash)
    ```

Now you've generated an API signature.

## Permissions
You can control the WaaS API usage with setting permissions.

### User role-based permissions
When you create an API key on Cobo Portal, you need to specify the user roles (viewer, spender, and operator) for the users with this API key. To learn more about the permissions for different roles, see [user roles and permissions](https://manuals.cobo.com/en/portal/organization/roles-and-permissions).

### Wallet-based permissions
When you create an API key on Cobo Portal, you need to select the wallets that can be accessed with this API key. Therefore, requests using this API key can only interact with the specified wallets.

## Path parameters
A path parameter is a variable segment embedded directly within the API endpoint URL. It allows you to specify a specific resource or data point within the API. 

- Retrieve information for a specific transaction with ID `a_transaction_id`: `GET /v2/transactions/a_transaction_id`
- Resend a failed transaction with ID `a_transaction_id`: `POST /v2/transactions/a_transaction_id/resend`

## Query parameters
A query parameter is a key-value pair appended to the end of a URL after a question mark. It allows you to filter or modify the response of an API request.

### Sorting
Some endpoints support the `sort_by` and the `direction` parameters, which enables you to sort the result based on a specified field in a specified order. 

For example, if you want to sort the transactions by the `status` field in descending order, you can add the parameters to the path as `GET /v2/transactions?sort_by=status&direction=DESC`.

### Pagination
Some endpoints support pagination to retrieve data in manageable chunks. You can control the page size and navigate through the dataset using three query parameters:

- `before`: This parameter specifies an object ID that acts as a starting point for retrieving data in reverse chronological order. For example, if you set `before` to `foo`, the response will contain data objects that come before the object with ID `foo`. You can retrieve the next page of data by setting `before` to the value of `pagination.after` from the previous response.

- `after`: This parameter specifies an object ID that acts as a starting point for retrieving data in chronological order. For example, if you set `after` to `bar`, the response will contain data objects that come after the object with ID `bar`. You can retrieve the next page of data by setting `after` to the value of `pagination.before` from the previous response. 

<Note>If both `before` and `after` are provided, only the `before` parameter will be used.</Note>

- `limit`: This parameter defines the maximum number of objects you want to receive in each response. The allowed range for limit is between 1 and 50.

For example, if you want to retrieve 30 transaction objects that comes before the response with `foo` as `pagination.before`, you can add the pagination parameters to the path as `GET /v2/transactions?limit=30&before=foo`.


## Understand and handle error codes
### Error codes

| Error code | Description | 
| ----------- | ----------- |
| `2000` | Internal error. |
| `2002`| Unsupported HTTP method.|
| `2003`| Missing required parameters. |
| `2006`| Illegal parameter format or value.|
| `2010`| Rate limit exceeded.|
| `2020`| Missing action parameter.  |
| `2021`| Missing handler definition. |
| `2022`| Missing required request headers. |
| `2023`| Verification failed. |
| `2024`| Authentication failed. |
| `2025`| Forbidden access to resources. |
| `2026`| Too many requests. |
| `2027`| Quota limit exceeded. |
| `2028`| Resource not found.|
| `2029`| Invalid status. |
| `2040`| Duplicate key violation. |

###  HTTP status codes 

| Status code | Description                                             |
| --------------- | ------------------------------------------------------------ |
| 200             | OK.                                                           |
| 400             | Bad request.                                                  |
| 401             | Unauthorized. Either the API key, signature, or timestamp is incorrect. |
| 403             | Forbidden. No access allowed.                                |
| 404             | Not Found. Requested resources not found.                    |
| 405             | Method Not Allowed. HTTP methods used not applicable to the requested resources. |
| 406             | Not Acceptable. Requested content format is not JSON.        |
| 429             | Too Many Requests. Requests are limited, please reduce the request frequency. |
| 500             | Internal Server Error. Internal server error, please try again later. |
| 502             | Bad Gateway.                                                  |
| 503             | Service Unavailable. Service unavailable, please try again later. |


## Rate and usage limiting

## Webhook events 
Upon receiving a deposit or withdrawal request, the WaaS service sends a push message that contains the transaction data in JSON format as an HTTP POST request to a user-defined URL. To learn more about how to subscribe to webhook events, see [Webhook events]().

## Callback messages
When you receives a webhook event and want to approve or reject the request, you need to respond promptly with an HTTP body containing either `ok` for approval or `deny` for rejection with an HTTP status of `200`. Failure to provide this response will result in delayed request processing and continued pushes of the same message to the designated URL. To learn more about how to subscribe to callback messages, see [Callback messages]().

## Glossary

- Asset: (This concept only applies to exchange wallets) A digital representation of a valuable resource on a blockchain network. Exchange wallets group your holdings by asset, even if the same asset exists on different blockchains. For example, if your Exchange Wallet has 1 Bitcoin on Ethereum and 1 Bitcoin on its native chain, then your asset balance is 2 Bitcoin.
- Chain: The specific blockchain network on which an asset or token resides. To learn more about the supported chains, see [Supported tokens and chains](https://manuals.cobo.com/en/portal/supported-tokens-custodial).
- Token: A specific type of cryptocurrency. Wallets track your balance for each individual token.To learn more about the supported tokens, see [Supported tokens and chains](https://manuals.cobo.com/en/portal/supported-tokens-custodial).
- API key: A unique identifier used to authenticate and authorize API requests. An API key allows an organization to initiate specific actions such as withdrawals. To learn how to create an API key, see [API keys]().
- Organization/Org: Organization serves as the cornerstone for streamlined account management. The admin of the organization have the exclusive rights to manage user profiles, designate roles, assign permissions, and enforce governance policies. To learn more about organizations, see [Introduction to Organization](https://manuals.cobo.com/en/portal/organization/introduction).
- Address: A unique identifier on a blockchain network used to send and receive cryptocurrency or other digital assets. It is recommended that you use a dedicated address for transactions of one token for MPC Wallets.
- Cancel: Revoke a pending transaction before it is broadcast on the blockchain. 
- Drop: Revoke a pending transaction before it is added to a block on the blockchain. Dropping a transaction will trigger a Replace-By-Fee (RBF) transaction, which allows the you to replace your unconfirmed transaction with a new one with a higher transaction fee. 
- Speed up: Increase the transaction fee associated with a pending transaction to incentivize miners to prioritize it and confirm it faster. Speeding up a transaction will also trigger a RBF transaction.
- Resend: Re-broadcast a transaction that hasn't been confirmed on the blockchain after a certain amount of time. Resending a transaction initiates a new attempt to process the transaction that failed previously.
- Replace: Create a new transaction that cancels a pending transaction and has a higher transaction fee to expedite confirmation.
- Contract call transaction: A transaction that interacts with a smart contract deployed on the blockchain. It typically involves transferring funds to the smart contract address and specifying the calldata that contains the function name and any required parameters.
- Message sign transaction: A transaction that cryptographically signs a message using your private key to prove ownership of a specific blockchain address. The signed message can be used for various purposes including verifying ownership and authorizing actions.
- Source: For a transaction, the source refers to the party that initiates the transaction. It can be a Custodial Wallet, a MPC Wallet, a Smart Contract Wallet, an Exchange Wallet, a Fee Station, or an external address. In a token transfer, the source refers to the sending address.
- Destination: For a transaction, the source refers to the party that receives the transaction. It can be a Custodial Wallet, a MPC Wallet, a Smart Contract Wallet, an Exchange Wallet, an external address, a message to be signed, or a smart contract. In a token transfer, the source refers to the deposit address.
- Transaction fee: A fee paid to miners or validators on a blockchain network to process and confirm a transaction. Transaction fee varies based on the fee model that the chain uses. They must be paid in the native currency of the blockchain.
- Transaction fee price: The per-unit fee or price charged for a transaction.
- Fee token: The token used to pay for a transaction fee, that is, the native currency of the blockchain.
- Fee Station: A service that automatically pays certain types of fees including transaction fee for all the users under the Organization.